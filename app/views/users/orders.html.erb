<div class="container my-5">
  <h1 class="mb-4">My Order History</h1>

  <% if @orders.any? %>
    <div class="row">
      <% @orders.each do |order| %>
        <div class="col-12 mb-4">
          <div class="card">
            <div class="card-header bg-primary text-white">
              <div class="row">
                <div class="col">
                  <h5 class="mb-0">Order #<%= order.id.to_s.rjust(6, '0') %></h5>
                </div>
                <div class="col-auto">
                  <%= order.created_at.strftime('%B %d, %Y') %>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-4">
                  <h6>Shipping Address</h6>
                  <p class="mb-2">
                    <%= order.ship_to_name %><br>
                    <%= order.address_line_1 %><br>
                    <% if order.address_line_2.present? %>
                      <%= order.address_line_2 %><br>
                    <% end %>
                    <%= order.city %>, <%= order.state %> <%= order.postal_code %><br>
                    <%= order.country %>
                  </p>
                </div>
                <div class="col-md-4">
                  <h6>Order Details</h6>
                  <p class="mb-1"><strong>Status:</strong> 
                    <span class="badge <%= order.paypal_payment_status == 'COMPLETED' ? 'bg-success' : 'bg-warning' %>">
                      <%= order.paypal_payment_status || 'Processing' %>
                    </span>
                  </p>
                  <p class="mb-1"><strong>Shipping:</strong> <%= order.shipping_method_name || 'Standard' %></p>
                  <p class="mb-1"><strong>PayPal Transaction:</strong> <%= order.paypal_transaction_id || 'N/A' %></p>
                </div>
                <div class="col-md-4">
                  <h6>Order Summary</h6>
                  <% order.order_items.each do |item| %>
                    <p class="mb-1">
                      <%= item.quantity %>x <%= item.product.name %> - $<%= item.total_price %>
                    </p>
                  <% end %>
                  <hr>
                  <p class="mb-1">Shipping: $<%= order.shipping_cost || '0.00' %></p>
                  <p class="mb-0"><strong>Total: $<%= order.final_price %></strong></p>
                </div>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <div class="alert alert-info" role="alert">
      <h4 class="alert-heading">No orders yet</h4>
      <p>You haven't placed any orders yet. Start shopping to see your order history here!</p>
      <hr>
      <p class="mb-0">
        <%= link_to "Start Shopping", products_path, class: "btn btn-primary" %>
      </p>
    </div>
  <% end %>
</div>