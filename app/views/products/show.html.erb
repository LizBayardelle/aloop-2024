<div id="productDetails" data-product="<%= @product.to_json(
  include: { 
    components: { 
      include: { 
        variants: { 
          include: { photos: { methods: :url } } 
        } 
      } 
    } 
  }
).gsub('"', '&quot;').html_safe %>">
</div>